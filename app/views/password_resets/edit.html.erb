<div class="row" style="font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif">
  <br>
  <div class="col l5 m8 s12" style="max-width:480px;margin:40px auto">
    <div class="card paletton-grey">
      <div class="card-content white-text">
        <!-- LOGO (igual que en password) -->
        <div class="row">
          <div class="col s12">
            <%= render "shared/lantialogo2" %>
          </div>
        </div>

        <!-- TÃTULO -->
        <div class="row">
          <div class="col s12">
            <span class="card-title center">Restablecer contraseÃ±a</span>
          </div>
        </div>

        <!-- ALERTAS -->
        <% if flash[:alert].present? %>
          <div class="row">
            <div class="col s12">
              <div style="background:#fee;border:1px solid #f99;padding:10px;margin:6px 0;border-radius:4px;color:#b00020">
                <%= flash[:alert] %>
              </div>
            </div>
          </div>
        <% end %>

        <!-- FORMULARIO (misma acciÃ³n/mÃ©todo que ya tenÃ­as) -->
        <%= form_with url: password_reset_path(@token), method: :patch, html: { style: "margin-top:4px" } do %>
          <%= hidden_field_tag :email, @user.mail %>

          <!-- NUEVA CONTRASEÃ‘A -->
          <div class="row" style="margin-bottom:14px">
            <div class="col s12 valign-wrapper" style="gap:10px">
              <span aria-hidden="true" style="display:inline-block;line-height:1;font-size:18px">ğŸ”’</span>

              <%= password_field_tag :password, nil,
                    required: true, minlength: 7,
                    placeholder: "Nueva contraseÃ±a",
                    id: "password-new",
                    class: "input-padding white",
                    style: "width:100%;padding:10px;border-radius:4px",
                    aria: { label: "Nueva contraseÃ±a" } %>

              <!-- Ojo sin Material Icons -->
              <button
                type="button"
                class="grey-text text-darken-2"
                onclick="togglePwd('password-new', this)"
                aria-label="Mostrar u ocultar contraseÃ±a"
                style="margin-left:-36px;background:transparent;border:0;cursor:pointer;padding:0;font-size:18px"
              >ğŸ‘</button>
            </div>
          </div>

          <!-- CONFIRMAR CONTRASEÃ‘A -->
          <div class="row" style="margin-bottom:14px">
            <div class="col s12 valign-wrapper" style="gap:10px">
              <span aria-hidden="true" style="display:inline-block;line-height:1;font-size:18px">ğŸ”‘</span>

              <%= password_field_tag :password_confirmation, nil,
                    required: true, minlength: 7,
                    placeholder: "Confirmar contraseÃ±a",
                    id: "password-confirm",
                    class: "input-padding white",
                    style: "width:100%;padding:10px;border-radius:4px",
                    aria: { label: "Confirmar contraseÃ±a" } %>

              <button
                type="button"
                class="grey-text text-darken-2"
                onclick="togglePwd('password-confirm', this)"
                aria-label="Mostrar u ocultar contraseÃ±a"
                style="margin-left:-36px;background:transparent;border:0;cursor:pointer;padding:0;font-size:18px"
              >ğŸ‘</button>
            </div>
          </div>

          <!-- BOTÃ“N ENVIAR (mismo estilo que en password) -->
          <div class="row">
            <div class="col s12">
              <div class="input-field valign-wrapper right short-row" style="margin-right:70px">
                <button class="btn-floating teal lighten-5" type="submit" aria-label="Guardar contraseÃ±a">
                  <span aria-hidden="true" class="grey-text text-darken-3" style="display:inline-block;font-size:20px;line-height:36px">â¤</span>
                </button>
              </div>
            </div>
          </div>

          <%# <div class="divider"></div> %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
  // Toggle de visibilidad, sin depender de Material Icons
  function togglePwd(id, btn) {
    var input = document.getElementById(id);
    if (!input) return;
    if (input.type === "password") {
      input.type = "text";
      btn.textContent = "ğŸ™ˆ";
    } else {
      input.type = "password";
      btn.textContent = "ğŸ‘";
    }
  }

  // Si usas Materialize, inicializa modales/estilos de forma segura (no es obligatorio aquÃ­)
  document.addEventListener('DOMContentLoaded', function() {
    try { if (window.M && M.AutoInit) M.AutoInit(); } catch(e) {}
  });
</script>

