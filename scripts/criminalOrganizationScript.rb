rawData = "Cártel de Sinaloa ,Cártel del Pacífico,CDS; CDP,Cártel ,,,Cártel de Guadalajara,,Cártel Jalisco Nueva Generación,1,1,1,1,1,1,,,1,1,1,,1,,,,,,1
Cártel Jalisco Nueva Generación ,,CJNG,Cártel ,,,Cártel del Milenio ,,Cártel de Sinaloa,1,1,1,1,1,1,,1,,1,1,,1,,,,,,
Cárteles Unidos ,,CU,Mafia,Célula,Cártel de Sinaloa ,Los Talibanes,Cártel de Sinaloa ,Cártel Jalisco Nueva Generación,1,1,1,,,,,,,,,,,,,,,,
Los Ciclones,,,Mafia ,Escisión,,Cártel del Golfo ,,,1,1,1,,,,,,,,,,,,,,,,
La Oficina,,,Banda,,Organización criminal de la familia Meza Flores,Organización criminal de Los Beltrán Leyva,Cártel Jalisco Nueva Generación ,,1,1,,,,,,,,,,,,,,,,,
Los Gloria,,,Banda,,,,,Cártel Jalisco Nueva Generación; Cártel de Sinaloa ,,1,1,,,,,1,,1,,,,,,,,,
La Línea,,,Mafia,Escisión,Nuevo Cártel de Juárez ,Cártel de Juárez ,Cártel Jalisco Nueva Generación ,,1,,,,,,,,,,,,,,,,,,
El 30,,,Banda,Brazo armado,Cártel de Sinaloa ,La Oficina,Cártel de Sinaloa;Cárteles Unidos,Cártel Jalisco Nueva Generación,1,1,1,,,,,,,,,,,,,,,,
Los Cuinis,Famila González Valencia,,Mafia,Célula,Cártel Jalisco Nueva Generación,Cártel del Milenio ,Cártel Jalisco Nueva Generación ,,,,,,,,,,,,1,,,,,,,,
XXXV,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los Monkikis,,,Banda ,Pandilla,,,,,,1,,,,,,,,,,,,,,,,,
Cártel de Tijuana Nueva Generación,,CTNG,Mafia,Célula,Cártel Jalisco Nueva Generación,Cártel Jalisco Nueva Generación; Cártel de Los Arellano Félix,,Cártel de Sinaloa; Cártel de Los Arellano Félix,1,1,,,,,,,,,,,,,,,,,
Los Arzate,Familia Arzate ,,Mafia,Célula,Cártel de Sinaloa ,Cártel de Sinaloa ,,Cártel de Los Arellano Félix; Cártel Jalisco Nueva Generación,1,1,,,,,,,,,,,,,,,,,
Cártel de Los Arellano Félix,Cártel de Tijuana,CAF;CT,Mafia,,,Cártel de Guadalajara,Organización criminal de la familia Meza Flores,Cártel de Sinaloa; Cártel Jalisco Nueva Generación,1,1,,,,,,,,1,1,,,,,,,,
Organización criminal de la familia Meza Flores,,,Mafia,,,Organización criminal de Los Beltrán Leyva,Cártel de Los Arellano Félix,Cártel de Sinaloa,1,,,,,,,,,,,,,,,,,,
Cártel de Santa Rosa de Lima,,SRL,Mafia,,,Los Zetas,,Cártel Jalisco Nueva Generación,1,,,,,,,,,,,,,,,,,,
Los Pilotos,,,Banda,,Cártel de Los Arellano Félix,Cártel de Los Arellano Félix,Organización criminal de la familia Meza Flores,Cártel Jalisco Nueva Generación; Cártel de Sinaloa,1,1,1,,,,,,,,,,,,,,,,
Los Venados,,,Banda,Brazo armado,Los Arzate,,Cártel de Sinaloa ,Cártel de Los Arellano Félix; Cártel Jalisco Nueva Generación,1,1,,,,,,,1,1,,,,,,,,,
Los Mudos,,,Banda ,Pandilla,,,,,,1,,,,,,,,,,,,,,,,,
Banda del Bebé,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,1,1,,
Banda de la Riviera Maya,,,Banda,,,,,,,,,,,,,,,,,,,,,,,,
Los 28,,,Banda,Brazo armado,Cártel Jalisco Nueva Generación,Los Dámaso,,Cártel de Sinaloa,1,1,1,,,,,,,,,,,,,,,,
Banda de la Zona Norte,Cártel de la Zona Norte,,Banda,,Cártel de Sinaloa ,Los Javieres,,,1,1,1,,,,,,1,,,,,,,,,,
Los Villavicencio,Familia Villavicencio ,,Mafia,Célula,Cártel de Sinaloa ,Cártel de Sinaloa ,,,1,,1,,,,,,,,,,,,,,,,
Los Zetas Vieja Escuela,,,Mafia,Escisión,,Los Zetas,,Cártel del Noreste,1,,,,1,,,,,,,,,,,,,,
Piratas del Carmen ,,,Banda,,,,,,,,,,,,,,,,,,,,,,,1,
Los Boxes,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,,,,,,
Cártel del Noreste,,,Mafia,Escisión,,Los Zetas,,Los Zetas Vieja Escuela; Cártel Jalisco Nueva Generación; Cártel de Sinaloa,1,1,,,,,,,,,,,,,,,,,
Banda de Hopelchén ,,,Banda,,,,,,1,,,,,,,,,,,,,,,,,,
Piratas de la Plaza de la Madre,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los TX8S,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los Destroyers,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los Distintos,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los Morgan,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Las Piratas ,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Las Fresas,,,Banda,Pandilla,,,,,,,,,,,,,,,,,,1,,,,,
Los Nuevos Aztecas,La Empresa; Los Nuevos Aztecas,,Banda,Pandilla,La Línea,Los Aztecas,La Línea,Los Mexicles; Los Artistas Asesinos; Los Aztecas Viejos,,1,,,,,,,,,,,,,,,,,1
Los Ántrax ,,,Banda,Banda,,,,,1,,,,,,,,,,,,,,,,,,
La Nueva Familia Michoacana,Los Viagra; organización criminal de la familia Sierra Santana,,Mafia,Escisión,,Los Caballeros Templarios,Cárteles Unidos; Cártel de Sinaloa,Cártel Jalisco Nueva Generación,1,,1,,,,,,,,,,,,,,,,
Los Blancos de Troya ,Los Troyanos,,Banda,Brazo armado,La Nueva Familia Michoacana,La Nueva Familia Michoacana,Cárteles Unidos; Cártel de Sinaloa,Cártel Jalisco Nueva Generación,1,,1,,,,,,,,,,,,,,,,
Barrio 18 ,,M-18,Banda,Pandilla,,,,Mara Salvatrucha ,,1,,,,,,,,,,,,,,,,,
Cartel de San Juan Chamula ,Cártel del Caracol,,Banda,,,,,,,1,1,,,,,,,,,,,,,,,,
Fuerzas Especiales Grupo Sombra,,FEGS,Banda,Brazo armado,,Cártel del Golfo,Cártel de Sinaloa ,Cártel Jalisco Nueva Generación ,1,1,,,,,,,,,,,,,,,,,
Mara Salvatrucha ,,M-13,Banda,Pandilla,,,,Barrio 18,,1,,,,,,,,,,,,,,,,,
Cártel de Nuevo Imperio,,,Banda,,,Los Dámaso,,,1,1,1,,,,,,,,,,,,,,,,
Cártel de Tláhuac,,TLH,Banda,,,La  Familia Michoacana,Cártel Jalisco Nueva Generación,,,1,1,,,,,,,,,,,,,,,,
La Ronda 88,,LR88,Banda,Pandilla,,La Unión Tepito,,La Unión Tepito,,1,1,,,,,,,,,,,,,,,,
La Unión Tepito,,,Mafia,,,Cártel de Tepito ,,,1,1,1,,1,1,,,,1,,,,,,,1,,
La Unión Tepito Nueva Generación ,Fuerza Anti-Unión Tepito,UTNG; FAT,Mafia,Célula,Cártel Jalisco Nueva Generación,La Unión Tepito,,La Unión Tepito,1,1,1,,,,,,,,,,,,,,,,
Los Boludos,Los Cambrón,,Banda,Pandilla,,Los Güeros,,,,1,,,,,,,,,,,,,,,,,
Los Canchola ,Los Malcriados; Tercera Acción Destructiva,,Banda,,,,La Unión Tepito,,,1,,,,,,,,,,,,,,,,,
Los Changos,,,Banda,Pandilla,,La Familia Michoacana ,,,,1,,,,,,1,,,,,,,,,,,
Los Discos,,,Banda,Pandilla,,,La Unión Tepito,,,1,,,,,,,,,,,,,,,,,
Los Güeros,Los Mamados; Cártel del H,,Banda,Pandilla,,,Los Rodolfos,Los Oaxacos,,1,1,,,,,,,,,,,,,,,,
Los Guerrero,,,Banda,Pandilla,,La Unión Tepito,,,,1,1,,,,,,,,,,,,,,,,
Los Maestrín,,,Banda,Pandilla,,,,Los Canchola ,,1,1,,,,,,,,,,,,,,,,
Los Marcopolos,,,Banda,,La Unión Tepito,La Unión Tepito,,,,,,,,,,,,1,1,,,,,,,,
Los Memos,Los Argüelles,,Banda,Pandilla,,,,La Unión Tepito,,1,1,,,,,,,,,,,,,,,,
Los Oaxacos,,,Banda,Pandilla,,,,Los Güeros,,1,1,,,,,1,,,,,,,1,,,,
Los Rodolfos,,,Banda,,,,Los Güeros,Los Molina,,1,1,,,,,1,,,,,,,,,,,
Los Rudos,Los Rudos Chicos; Los Rudos Grandes,,Banda,Pandilla,,,,,,1,1,,,,,,,,,,,1,,1,1,,
Los Sinaloas,,,Banda,,Cártel de Sinaloa,,,La Unión Tepito Nueva Generación ,1,,1,,,,,,,,,,,,,,,,
Los Tanzanios,,,Banda,Pandilla,,,Cártel de Tláhuac,,,1,1,,,,,1,,,,,,,,,1,,
Los Villafán,,,Banda,Pandilla,,,La Ronda 88,,,1,1,,,,,,,,,,,,,,,,
Los Molina,,,Banda,Pandilla,,,,Los Rodolfos,,1,1,,,,,1,,,,,,,,,,,
Los Chilas,,,Banda,Pandilla,,,La Unión Tepito,,,1,,,,,,,,,,,,1,1,,,,
Sindicato Libertad,Confederación Libertad de Trabadores de México,,Mafia,,,,Guerreros Unidos; La Unión Tepito,La Unión Tepito,,,1,1,,,,,,,1,,,,,,,,
Fuerzas Especiales Mexicles ,,FEM,Banda,Pandilla,Nuevo Cártel de Juárez ,Los Mexicles,Nuevo Cártel de Juárez,Cártel de Sinaloa,,,1,,,,,,,,,,,,1,,1,,
Los Jaguares,Gente Nueva El Jaguar,,Banda,Brazo armado,Los Paredes,Nuevo Cártel del Tigre,Cártel de Sinaloa; Los Salazar,La Línea,1,,,,,1,,,,,,,,,,,,,
Los Salazar,Familia Salazar,,Mafia,Célula,Cártel de Sinaloa,,Cártel de Sinaloa,Los Memos,1,,1,,1,1,,,,,1,,,,,,,,"

divisions = [
	{:slot=>9,:scian3=>981,:name=>"Narcotráfico"},
	{:slot=>10,:scian3=>982,:name=>"Narcomenudeo"},
	{:slot=>11,:scian3=>983,:name=>"Extorsión"},
	{:slot=>12,:scian3=>984,:name=>"Mercado Ilícito de Hidrocarburos"},
	{:slot=>13,:scian3=>985,:name=>"Trata y tráfico de personas"},
	{:slot=>14,:scian3=>986,:name=>"Tráfico de armas"},
	{:slot=>15,:scian3=>987,:name=>"Robo de ferrocarril"},
	{:slot=>16,:scian3=>988,:name=>"Robo de transportistas"},
	{:slot=>17,:scian3=>989,:name=>"Tala clandestina"},
	{:slot=>18,:scian3=>991,:name=>"Contrabando de mercancías"},
	{:slot=>19,:scian3=>992,:name=>"Lavado de dinero"},
	{:slot=>21,:scian3=>993,:name=>"Actos de terrorismo"}
]

organizationArr = []
rawData.each_line{|l| line = l.split(","); organizationArr.push(line)}
organizationArr.each{|x|x.each{|y|y.strip!}}
organizationArr.each{|x|

# CREATE ORGANIZATION IF IT DOES NOT EXIST
	if Organization.where(:name=>x[0]).empty?
		print "NEW ORGANIZATION :" + x[0]
		Organization.create(:name=>x[0],:acronym=>x[2],:league=>x[3],:subleague=>x[4])
	end

# UPDATE DIVIDIONS
	targetOrganization = Organization.where(:name=>x[0]).last
	divisions.each{|y|
		myDivision = Division.where(:scian3=>y[:scian3]).last
		if x[y[:slot]] == "1"
			print "ACITVITY HIT!!!"
			targetOrganization.divisions << myDivision
		end
	}
}

# UPDATE PARENT ORIGIN ALLIES AND RIVALS 
organizationArr.each{|x|
	targetOrganization = Organization.where(:name=>x[0]).last
	unless x[1].empty?
		myNames = x[1].split(";")
		cleanNames = []
		myNames.each {|myName|
			myName = myName.strip
			cleanNames.push(myName)
		}
		targetOrganization.update(:alias=>cleanNames)
	end	
	unless x[5].empty?
		unless Organization.where(:name=>x[5]).empty?
			parentOrganization = Organization.where(:name=>x[5]).last
			targetOrganization.update(:parent_id=>parentOrganization.id)
		end
	end
	unless x[6].empty?
		x[6].split(";").each{|org|
			myOrigins = []
			unless Organization.where(:name=>org).empty?
				originOrganization = Organization.where(:name=>org).last
				myOrigins.push(originOrganization.id)
			end	
			targetOrganization.update(:origin=>myOrigins)	
		}
	end	
	unless x[7].empty?
		x[7].split(";").each{|org|
			myAllies = []
			unless Organization.where(:name=>org).empty?
				alliedOrganization = Organization.where(:name=>org).last
				myAllies.push(alliedOrganization.id)
			end	
			targetOrganization.update(:allies=>myAllies)	
		}
	end	
	unless x[8].empty?
		x[8].split(";").each{|org|
			myRivals = []
			unless Organization.where(:name=>org).empty?
				rivalOrganization = Organization.where(:name=>org).last
				myRivals.push(rivalOrganization.id)
			end
			print "***************RivalArr: "
			print myRivals	
			targetOrganization.update(:rivals=>myRivals)	
		}
	end	
}



